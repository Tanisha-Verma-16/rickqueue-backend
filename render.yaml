# services:
#   # Web Service (Backend API)
#   - type: web
#     name: rickqueue-backend
#     env: python
#     region: singapore
#     plan: free
#     branch: main
#     buildCommand: pip install -r requirements.txt
#     startCommand: alembic upgrade head && uvicorn app.main:socket_app --host 0.0.0.0 --port $PORT
#     healthCheckPath: /health
#     envVars:
#       - key: ENVIRONMENT
#         value: production
#       - key: DEBUG
#         value: false
#       - key: LOG_LEVEL
#         value: INFO
#       - key: PYTHON_VERSION
#         value: 3.11.0
#       # Database URL will be auto-populated from database
#       - key: DATABASE_URL
#         fromDatabase:
#           name: rickqueue-db
#           property: connectionString
#       # Firebase credentials - you'll add this manually
#       - key: FIREBASE_CREDENTIALS
#         sync: false

# # Databases are a peer to 'services', not a child of it
# databases:
#   - name: rickqueue-db
#     region: singapore
#     plan: free
#     databaseName: rickqueue
#     user: rickqueue # Note: The key is usually just 'user', not 'databaseUser' in some contexts, but check Render docs. 'user' is standard.
#     ipAllowList: []

services:
  # Web Service (Backend API)
  - type: web
    name: rickqueue-backend
    env: python
    region: singapore # Change to your region: oregon, frankfurt, singapore
    plan: free # FREE TIER
    branch: main
    buildCommand: pip install --upgrade pip && pip install -r requirements.txt
    startCommand: alembic upgrade head && uvicorn app.main:socket_app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: false
      - key: LOG_LEVEL
        value: INFO
      - key: PYTHON_VERSION
        value: 3.11.0
      # Database URL will be auto-populated from database
      - key: DATABASE_URL
        fromDatabase:
          name: rickqueue-db
          property: connectionString
      # Firebase credentials - you'll add this manually
      - key: FIREBASE_CREDENTIALS
        sync: false # You'll set this in dashboard

  # PostgreSQL Database
  - type: pgsql
    name: rickqueue-db
    region: singapore # Same region as web service
    plan: free # FREE TIER
    databaseName: rickqueue
    databaseUser: rickqueue
    ipAllowList: [] # Allow all IPs (for web service)
